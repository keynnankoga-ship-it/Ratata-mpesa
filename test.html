<!DOCTYPE html>
<html>
<head>
  <title>Ratata Sandbox STK Test</title>
  <style>
    body { background:#111; color:white; font-family:Arial, sans-serif; text-align:center; padding:50px; }
    input { padding:10px; width:200px; margin:5px 0; }
    button { padding:10px 20px; font-size:16px; cursor:pointer; }
    #response { margin-top:20px; color:#ff7a2f; }
  </style>
</head>
<body>
  <h1>Ratata Payment Test</h1>
  <p>Enter your phone (sandbox) and amount:</p>
  <input type="text" id="phone" placeholder="254708374149"><br>
  <input type="number" id="amount" placeholder="1"><br><br>
  <button onclick="pay()">Pay Now</button>
  <p id="response"></p>

  <script>
    async function pay() {
      const phone = document.getElementById("phone").value.trim();
      const amount = document.getElementById("amount").value.trim();
      const responseEl = document.getElementById("response");

      responseEl.innerText = "Processing...";

      try {
        const res = await fetch("http://localhost:5000/stkpush", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ phone, amount })
        });

        const data = await res.json();

        if (!res.ok) {
  // If data.error is an object, stringify it
  const errorMsg = typeof data.error === "object" ? JSON.stringify(data.error, null, 2) : data.error;
  responseEl.innerText = "Error: " + errorMsg;
} else {
  responseEl.innerText = data.message;
  console.log("STK Response:", data.data);
}


      } catch (err) {
        responseEl.innerText = "Network error: " + err.message;
      }
    }
  </script>
</body>
</html>
